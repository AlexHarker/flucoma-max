language:
- objective-c
- c++

compiler:
- clang

sudo: false
os: osx
osx_image: xcode7.3

script:
- mkdir build
- cd build
- cmake -G Xcode ..
- cmake --build . --config Release
#- cmake --test
- cd ..
- PACKAGE_NAME=`echo $TRAVIS_REPO_SLUG | sed 's/.*\///g'`
- PACKAGE_REV=`echo $TRAVIS_COMMIT | sed -e 's/^[[:alnum:]]\{6\}/&-/g' | sed 's/-.*//'`
- mkdir $PACKAGE_NAME
- if [ -e *.json ]; then cp *.json $PACKAGE_NAME; fi
- if [ -e *.md ]; then cp *.json $PACKAGE_NAME; fi
- if [ -e *.png ]; then cp *.json $PACKAGE_NAME; fi
- if [ -d docs ]; then cp -r docs $PACKAGE_NAME; fi
- if [ -d externals ]; then cp -r externals $PACKAGE_NAME; fi
- if [ -d extras ]; then cp -r extras $PACKAGE_NAME; fi
- if [ -d help ]; then cp -r help $PACKAGE_NAME; fi
- if [ -d init ]; then cp -r init $PACKAGE_NAME; fi
- if [ -d javascript ]; then cp -r javascript $PACKAGE_NAME; fi
- if [ -d media ]; then cp -r media $PACKAGE_NAME; fi
- if [ -d misc ]; then cp -r misc $PACKAGE_NAME; fi
- if [ -d patchers ]; then cp -r help $PACKAGE_NAME; fi
- zip -r $PACKAGE_NAME-$PACKAGE_REV.zip $PACKAGE_NAME

addons:
  artifacts:
    s3_region: us-west-2
    paths:
    - "$PACKAGE_NAME-$PACKAGE_REV.zip"

env:
  global:
  - ARTIFACTS_BUCKET=cycling74-ci
  - ARTIFACTS_KEY=AKIAIWE3SI2TMXC5AJBA
  - secure: "rV67ClxSKj0wER+8E+vF0W6Emd69ePSL32dRxeG3KwA4ZhMF71r2FnjQNqE9zFc67DV/XdIiGSTxaLmAx2zZgLMgQBk+Cn+Y8IzExUD5iYhia2YV0iirge3b8KzncfMpMcuVFLZyn9cvu0NIorvFGIrCkygtn3s2GNJVSX44xs53AOaNyUARSdJbZVUhiA+5uHDdOzAl28/DlSo22pCjn9rb+o69ti0apAseT8qsnNO/mBBNDj0ZKK2WaE1nxZfcQmu+spM3sTzCKZdou2vXasnU7CAXvNmYu6okXMjOglCSDGJoaxrHebSo2RuKwAYjTOj0Dz+NW8TJQHYWY4K0w3039pionLnNiUT/mOEmAzXLjj+FWPBdWIgtA18OZWQnN6P6y9cldMUQvfduo8RPTjup6S+vAEo6AyUytVe3zUdHsIESRwew3uQdGjSLn7AONDIYjINSVpvMm80janBluxIHAiuoHMTwobMX2DD4FsTn9eBPgODvH99eAffbVthGTqhTAcrXxwE4Qm3oHhbeVg00UpcfVQ7gm0GFJDlb/rixAlNGDugxmr9Lz2pMlXrnEFPgHs/4CBd+zVqNYaLiXKG29bc9Cl6FmicX5c2IHBLaNnm+wlkXXna0PIgCpkEQ9rkYgwInESvn7R1WNCWNTIPjn/UxyZBzb/vVwgb/rDw="
